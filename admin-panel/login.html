<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Huglu Admin - Giriş</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body{margin:0;min-height:100vh;overflow:hidden;background:#0b1220;color:#111;display:flex;align-items:center;justify-content:center}
        #bg{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0}
        .login-card{position:relative;z-index:1;width:100%;max-width:420px;background:rgba(255,255,255,.9);backdrop-filter:blur(6px);border-radius:16px;box-shadow:0 12px 40px rgba(0,0,0,.25);padding:28px;margin:0 auto}
        .login-header{display:flex;align-items:center;gap:12px;margin-bottom:16px}
        .login-header img{width:40px;height:40px;border-radius:10px;object-fit:cover}
        .login-header h1{font-size:20px;margin:0;color:#0b1220}
        .login-sub{color:#6b7280;margin:0 0 18px 0;font-size:13px}
        .form-group{display:flex;flex-direction:column;margin-bottom:12px}
        .form-group label{font-weight:600;margin-bottom:6px}
        .form-group input{padding:12px 12px;border:1px solid #e5e7eb;border-radius:10px;font-size:14px;background:#fff}
        .btn{display:inline-flex;align-items:center;justify-content:center;width:100%;padding:12px 14px;border:none;border-radius:10px;cursor:pointer;font-weight:600}
        .btn-primary{background:linear-gradient(135deg,#7c3aed,#2563eb);color:#fff;box-shadow:0 6px 16px rgba(37,99,235,.35)}
        .helper{display:flex;justify-content:space-between;align-items:center;margin:8px 0 0 0}
        .helper a{color:#667eea;text-decoration:none;font-size:13px}
        .error{display:none;margin:8px 0 0 0;color:#dc2626;font-weight:600;font-size:13px}
        .env-tip{margin-top:14px;color:#6b7280;font-size:12px}
    </style>
</head>
<body>
    <canvas id="bg"></canvas>
    <div class="login-card">
        <div class="login-header">
            <img src="../assets/logo-removebg-preview.png" alt="Logo">
            <h1>Huglu Admin</h1>
        </div>
        <p class="login-sub">Yönetim paneline erişmek için giriş yapın.</p>

        <div class="form-group">
            <label for="username">Kullanıcı Adı</label>
            <input id="username" type="text" placeholder="kullanıcı adı" value="">
        </div>
        <div class="form-group">
            <label for="password">Şifre</label>
            <input id="password" type="password" placeholder="şifre" value="">
        </div>
        <button class="btn btn-primary" id="loginBtn"><i class="fas fa-sign-in-alt" style="margin-right:8px"></i>Giriş Yap</button>
        <div id="loginError" class="error">Giriş başarısız. Lütfen bilgileri kontrol edin.</div>
    </div>

    <script>
    // Lightweight Three.js particle background
    (function(){
        const canvas = document.getElementById('bg');
        const renderer = new THREE.WebGLRenderer({ canvas, antialias: true, alpha: true });
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 1000);
        camera.position.z = 60;

        const particles = 800;
        const geom = new THREE.BufferGeometry();
        const positions = new Float32Array(particles * 3);
        for (let i=0;i<particles;i++){
            positions[i*3+0] = (Math.random()-0.5)*180;
            positions[i*3+1] = (Math.random()-0.5)*100;
            positions[i*3+2] = (Math.random()-0.5)*180;
        }
        geom.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        const material = new THREE.PointsMaterial({ color: 0x6ee7ff, size: 1.2, transparent:true, opacity:0.7 });
        const points = new THREE.Points(geom, material);
        scene.add(points);

        const resize = () => {
            const w = window.innerWidth, h = window.innerHeight;
            renderer.setSize(w, h);
            camera.aspect = w/h; camera.updateProjectionMatrix();
        };
        window.addEventListener('resize', resize);
        resize();

        let t = 0;
        function animate(){
            t += 0.003;
            points.rotation.y = t;
            renderer.render(scene, camera);
            requestAnimationFrame(animate);
        }
        animate();
    })();
    (function(){
        const $ = sel => document.querySelector(sel);
        const usernameInput = $('#username');
        const passwordInput = $('#password');
        const errorBox = $('#loginError');
        const API_BASE = 'https://api.zerodaysoftware.tr/api';

        document.getElementById('loginBtn').addEventListener('click', async function(){
            errorBox.style.display = 'none';
            const username = usernameInput.value.trim();
            const password = passwordInput.value.trim();
            if (!username || !password) {
                errorBox.textContent = 'Lütfen kullanıcı adı ve şifreyi girin.';
                errorBox.style.display = 'block';
                return;
            }

            try {
                const res = await fetch(API_BASE + '/admin/login', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ username, password }) });
                if (!res.ok) throw new Error('Giriş başarısız');
                const data = await res.json();
                if (data && data.success && data.token) {
                    try {
                        localStorage.setItem('ADMIN_TOKEN', data.token);
                    } catch (_) {}
                    window.location.href = 'index.html';
                } else {
                    throw new Error('Geçersiz yanıt');
                }
            } catch (e) {
                errorBox.textContent = 'Giriş başarısız. Sunucuya ulaşılamadı veya anahtar hatalı.';
                errorBox.style.display = 'block';
            }
        });
    })();
    </script>
</body>
</html>


